function i(n){for(let t=0;t<n.attributes.length;t++)if(n.attributes[t].name.startsWith("_bl_"))return n.attributes[t].name;return null}function n(n,t,i){n!=null&&t in n&&n[t](i)}export function registerCallback(f,e,o,s,h,c){if(e&&(s==="enter"||s==="leave")){const l=i(e);l&&(l in t&&t[l].cancel(),c>0?u(l,f,e,o,s,h,c):r(l,f,e,o,s,h),h=h+"-"+s,requestAnimationFrame(()=>{n(o,"before"+s[0].toUpperCase()+s.substr(1),e),e.classList.add(h),requestAnimationFrame(()=>{e.classList.add(h+"-active"),requestAnimationFrame(()=>{e.classList.remove(h),s==="leave"&&e.classList.add(h+"-to")})})}))}}function r(i,r,u,f,e,o){const c=!0,s=c?"transitionend":"animationend";o=o+"-"+e;const h=l=>{l.target===u&&(r.invokeMethodAsync("HandleCallback",c?l.propertyName:l.animationName),e==="leave"?(u.classList.remove(o+"-active",o+"-to"),n(f,"afterLeave",u)):requestAnimationFrame(()=>{u.classList.add(o+"-to"),requestAnimationFrame(()=>{u.classList.remove(o+"-to"),u.classList.remove(o+"-active"),n(f,"afterEnter",u)})}),u.removeEventListener(s,h),delete t[i])};u.addEventListener(s,h);t[i]={cancel:function(){u.classList.remove(o,o+"-active",o+"-to");u.removeEventListener(s,h);n(f,e+"Cancelled",u)}}}function u(i,r,u,f,e,o,s){o=o+"-"+e;const h=()=>{r.invokeMethodAsync("HandleCallback",null),e==="leave"?(u.classList.remove(o+"-active",o+"-to"),n(f,"afterLeave",u)):requestAnimationFrame(()=>{u.classList.add(o+"-to"),requestAnimationFrame(()=>{u.classList.remove(o+"-to"),u.classList.remove(o+"-active"),n(f,"afterEnter",u)})}),delete t[i]},c=setTimeout(h,s);t[i]={cancel:function(){u.classList.remove(o,o+"-active",o+"-to");clearTimeout(c);n(f,e+"Cancelled",u)}}}const t={};